---
title: Reactでスライダーでも直接入力でも数値入力ができるコンポーネントを作ってみた
tags:
  - React
  - TypeScript
private: false
updated_at: ''
id: null
organization_url_name: null
slide: false
ignorePublish: false
---
# Reactでスライダーでも直接入力でも数値入力ができるコンポーネントを作ってみた
HTMLでユーザーに数値を指定させるときに使う要素としては`<input type="number">`や`<input type="range">`がありますが、[^1]いずれも一長一短です。
[^1]: 両方とも未対応のブラウザは窓から投げ捨てましょう。

- `<input type="number">`は厳密な値を入力する際には便利ですが、マウスのみでちゃちゃっと指定したいときには面倒です。[^2]
- `<input type="range">`は逆にマウスのみで簡単に数値を選べますが、厳密な値を指定するのには向いていません。[^3]
[^2]: スピンボタンを用いればマウスのみでも指定できますが、値によってはかなり長い時間押しっぱなしにする必要があるのでお世辞にも便利とは言えません。
[^3]: マウスを1px単位で動かす簡単なお仕事はしたくありません。

しかしこの2つを組み合わせればお互いの欠点を補えるため、非常に利便性の高いコンポーネントになるはずです。

というわけでReactでこれを作ってみました。

## 使用パッケージ
いずれも記事執筆時点での最新です。
|パッケージ|バージョン|
|---|---|
|vite|5.4.0|
|react|18.3.1|
|recoil|0.7.7|
|tailwindcss|3.4.9|
|daisyui|4.12.10|

## コンポーネントの仕様策定
細かいところは様々なやり方があるとは思いますが、今回は以下の方針にします。

※ `atom`はユーザーが指定した数値を状態に持つ変数を示します。

- `<input type="range">`の値が変更されたとき
  - `<input type="number">`および`atom`の内容を更新する
- `<input type="number">`が入力中のとき
  - 入力内容が数値として解釈できる場合のみ`<input type="range">`の値を更新する
    - ただし値が`max`を超えている場合は`max`に、`min`未満の場合は`min`に矯正する
  - `atom`は更新しない
- `<input type="number">`からフォーカスが失われたとき、
  - 内容が数値として解釈できない場合、`defaultValue`に矯正する
  - 内容が数値として解釈できる場合、`max`を超えている場合は`max`に、`min`未満の場合は`min`に矯正する
  - `atom`を矯正後の値で更新する
- `<input type="number">`のスピンボタンが押されたとき
  - `<input type="range">`および`atom`の内容を更新する